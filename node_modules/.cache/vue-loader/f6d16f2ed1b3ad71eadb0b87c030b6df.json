{"remainingRequest":"/home/soojy/Documents/projects/vuetify-surpk/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/soojy/Documents/projects/vuetify-surpk/src/components/ItemList.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/soojy/Documents/projects/vuetify-surpk/src/components/ItemList.vue","mtime":1619749475467},{"path":"/home/soojy/Documents/projects/vuetify-surpk/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/soojy/Documents/projects/vuetify-surpk/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/soojy/Documents/projects/vuetify-surpk/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/soojy/Documents/projects/vuetify-surpk/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBJdGVtIGZyb20gIi4vSXRlbSI7CmltcG9ydCB7IGJ1cyB9IGZyb20gIkAvYnVzIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJBcHAiLAogIGNvbXBvbmVudHM6IHsKICAgIEl0ZW0sCiAgfSwKICBwcm9wczogewogICAgc291cmNlOiBTdHJpbmcsCiAgfSwKICBtb3VudGVkKCkgewogICAgY29uc29sZS5sb2coMTIzMTIzKTsKICAgIGJ1cy4kb24oImNyZWF0ZS1Ub2RvIiwgKGRhdGEpID0+IHsKICAgICAgdGhpcy5jcmVhdGVUb2RvKGRhdGEpOwogICAgfSk7CiAgICBmZXRjaCgiaHR0cDovL3N1cnBrLWFwaS1sYXN0Lmhlcm9rdWFwcC5jb20vcHVibGljL2FwaS9wb3N0IikKICAgICAgLnRoZW4oKHJlc3BvbnNlKSA9PiByZXNwb25zZS5qc29uKCkpCiAgICAgIC50aGVuKChqc29uKSA9PiB7CiAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7CiAgICAgICAgICB0aGlzLnRvZG9zID0ganNvbjsKICAgICAgICAgIGNvbnNvbGUubG9nKGpzb24pOwogICAgICAgICAgdGhpcy5sb2FkaW5nID0gdHJ1ZTsKICAgICAgICB9LCAxMDAwKTsKICAgICAgfSk7CiAgfSwKICBkYXRhOiBmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gewogICAgICBmaXJzdG5hbWU6ICIiLAogICAgICBsYXN0bmFtZTogIiIsCiAgICAgIGRyYXdlcjogZmFsc2UsCiAgICAgIGRpYWxvZzogZmFsc2UsCiAgICAgIGl0ZW1zOiBbItCh0J8tMSIsICLQodCfLTIiLCAi0KHQny0zIiwgItCh0J8tNCJdLAogICAgICB0b2RvczogW10sCiAgICAgIHRva2VuOiBudWxsLAogICAgfTsKICB9LAoKICBtZXRob2RzOiB7CiAgICBkZWxUb2RvKGlkKSB7CiAgICAgIGNvbnNvbGUubG9nKGlkKTsKICAgICAgZmV0Y2goYGh0dHA6Ly9zdXJway1hcGktbGFzdC5oZXJva3VhcHAuY29tL3B1YmxpYy9hcGkvcG9zdC8ke2lkWzBdfWAsIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5nZXRUb2tlbigpfWAsCiAgICAgICAgICBBY2NlcHQ6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgfSwKICAgICAgICBtZXRob2Q6ICJERUxFVEUiLAogICAgICB9KS50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgIGlmIChyZXNwb25zZS5zdGF0dXMgPT0gMjAyKSB7CiAgICAgICAgICB0aGlzLmFsZXJ0KCLQo9C00LDQu9C10L3QuNC1INGD0YHQv9C10YjQvdC+IiwgImluZm8iKTsKICAgICAgICAgIHRoaXMudG9kb3Muc3BsaWNlKGlkWzFdLCAxKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSA0MDEpIHsKICAgICAgICAgICAgdGhpcy5hbGVydCgi0J7RiNC40LHQutCwINCw0YPRgtC10L3RgtC40YTQuNC60LDRhtC40LgiLCAiZXJyb3IiKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuYWxlcnQoItCe0YjQuNCx0LrQsCIsICJlcnJvciIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgc3RhcnRUb2RvKGlkKSB7CiAgICAgIGNvbnNvbGUubG9nKGlkKTsKICAgICAgZmV0Y2goYGh0dHA6Ly9zdXJway1hcGktbGFzdC5oZXJva3VhcHAuY29tL3B1YmxpYy9hcGkvcG9zdC8ke2lkWzBdfWAsIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5nZXRUb2tlbigpfWAsCiAgICAgICAgICBBY2NlcHQ6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgfSwKICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IHN0YXR1czogMiB9KSwKICAgICAgICBtZXRob2Q6ICJQQVRDSCIsCiAgICAgIH0pLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSAyMDIpIHsKICAgICAgICAgIHRoaXMuYWxlcnQoItCX0LDRj9Cy0LrQsCDQv9GA0LjQvdGP0YLQsCIsICJzdWNjZXNzIik7CiAgICAgICAgICB0aGlzLnRvZG9zW2lkWzFdXS5zdGF0dXMgPSAyOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IDQwMSkgewogICAgICAgICAgICB0aGlzLmFsZXJ0KCLQntGI0LjQsdC60LAg0LDRg9GC0LXQvdGC0LjRhNC40LrQsNGG0LjQuCIsICJlcnJvciIpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgdGhpcy5hbGVydCgi0J7RiNC40LHQutCwIiwgImVycm9yIik7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBmaW5pc2hUb2RvKGlkKSB7CiAgICAgIGNvbnNvbGUubG9nKGlkKTsKICAgICAgZmV0Y2goYGh0dHA6Ly9zdXJway1hcGktbGFzdC5oZXJva3VhcHAuY29tL3B1YmxpYy9hcGkvcG9zdC8ke2lkWzBdfWAsIHsKICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dGhpcy5nZXRUb2tlbigpfWAsCiAgICAgICAgICBBY2NlcHQ6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICJDb250ZW50LVR5cGUiOiAiYXBwbGljYXRpb24vanNvbiIsCiAgICAgICAgfSwKICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7IHN0YXR1czogMyB9KSwKICAgICAgICBtZXRob2Q6ICJQQVRDSCIsCiAgICAgIH0pLnRoZW4oKHJlc3BvbnNlKSA9PiB7CiAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSAyMDIpIHsKICAgICAgICAgIHRoaXMuYWxlcnQoItCX0LDRj9Cy0LrQsCDQt9Cw0LLQtdGA0YjQtdC90LAiLCAic3VjY2VzcyIpOwogICAgICAgICAgdGhpcy50b2Rvc1tpZFsxXV0uc3RhdHVzID0gMzsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSA0MDEpIHsKICAgICAgICAgICAgdGhpcy5hbGVydCgi0J7RiNC40LHQutCwINCw0YPRgtC10L3RgtC40YTQuNC60LDRhtC40LgiLCAiZXJyb3IiKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHRoaXMuYWxlcnQoItCe0YjQuNCx0LrQsCIsICJlcnJvciIpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAoKICAgIGFzeW5jIGNyZWF0ZVRvZG8oZGF0YSkgewogICAgICBsZXQgcmVzdWx0OwogICAgICBsZXQgcyA9IGF3YWl0IGZldGNoKAogICAgICAgIGBodHRwOi8vc3VycGstYXBpLWxhc3QuaGVyb2t1YXBwLmNvbS9wdWJsaWMvYXBpL3Bvc3RgLAogICAgICAgIHsKICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3RoaXMuZ2V0VG9rZW4oKX1gLAogICAgICAgICAgICBBY2NlcHQ6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uIiwKICAgICAgICAgIH0sCiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeShkYXRhKSwKICAgICAgICAgIG1ldGhvZDogIlBPU1QiLAogICAgICAgIH0KICAgICAgKQogICAgICAgIC50aGVuKChyZXNwb25zZSkgPT4gewogICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1cyA9PSAyMDEpIHsKICAgICAgICAgICAgdGhpcy5hbGVydCgi0KHQvtC30LTQsNC90LjQtSDRg9GB0L/QtdGI0L3QviIsICJpbmZvIik7CiAgICAgICAgICAgIHJlc3VsdCA9IDE7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBpZiAocmVzcG9uc2Uuc3RhdHVzID09IDQwMSkgewogICAgICAgICAgICAgIHRoaXMuYWxlcnQoItCe0YjQuNCx0LrQsCDQsNGD0YLQtdC90YLQuNGE0LjQutCw0YbQuNC4IiwgImVycm9yIik7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgdGhpcy5hbGVydCgi0J7RiNC40LHQutCwIiwgImVycm9yIik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7CiAgICAgICAgfSkKICAgICAgICAudGhlbigoZGF0YSkgPT4gewogICAgICAgICAgcmV0dXJuIGRhdGE7CiAgICAgICAgfSk7CiAgICAgIGlmIChyZXN1bHQgPT0gMSkgewogICAgICAgIHMudXNlciA9IHRoaXMuZ2V0VXNlcm5hbWUoKTsKICAgICAgICBzLnN0YXR1cyA9IDE7CiAgICAgICAgY29uc29sZS5sb2cocyk7CgogICAgICAgIHRoaXMudG9kb3MucHVzaChzKTsKICAgICAgfQogICAgfSwKICAgIGFsZXJ0KHRleHQsIHR5cGUsIGR1cmF0aW9uKSB7CiAgICAgIHRoaXMuJGVtaXQoImFsZXJ0IiwgdGV4dCwgdHlwZSwgZHVyYXRpb24pOwogICAgfSwKICAgIGdldFRva2VuKCkgewogICAgICBpZiAodGhpcy50b2tlbiA9PSBudWxsKSB7CiAgICAgICAgbGV0IHVzZXIgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1c2VyIikpOwogICAgICAgIHRoaXMudG9rZW4gPSB1c2VyLnRva2VuOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLnRva2VuOwogICAgfSwKICAgIGdldFVzZXJuYW1lKCkgewogICAgICBpZiAodGhpcy51c2VybmFtZSA9PSBudWxsKSB7CiAgICAgICAgbGV0IHVzZXIgPSBKU09OLnBhcnNlKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJ1c2VyIikpOwogICAgICAgIHRoaXMudXNlcm5hbWUgPSB1c2VyLnVzZXJuYW1lOwogICAgICB9CiAgICAgIHJldHVybiB0aGlzLnVzZXJuYW1lOwogICAgfSwKICAgIC8vIGFkZFRvZG8odG9kb05ldykgewogICAgLy8gICAvLyBjb25zb2xlLmxvZyh0aGlzKTsKICAgIC8vICAgLy8gY29uc29sZS5sb2codG9kb05ldyk7CiAgICAvLyB9LAogIH0sCn07Cg=="},{"version":3,"sources":["ItemList.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;AAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ItemList.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <v-expansion-panels accordion focusable class=\"mt-3\">\n    <transition-group class=\"w-100\" name=\"fade\"\n      ><item\n        @del-todo=\"delTodo\"\n        @start-todo=\"startTodo\"\n        @finish-todo=\"finishTodo\"\n        class=\"w-100\"\n        v-for=\"(todo, index) in todos\"\n        v-bind:todo=\"todo\"\n        v-bind:count=\"index\"\n        v-bind:key=\"todo.id\"\n      ></item\n    ></transition-group>\n  </v-expansion-panels>\n</template>\n\n<script>\nimport Item from \"./Item\";\nimport { bus } from \"@/bus\";\nexport default {\n  name: \"App\",\n  components: {\n    Item,\n  },\n  props: {\n    source: String,\n  },\n  mounted() {\n    console.log(123123);\n    bus.$on(\"create-Todo\", (data) => {\n      this.createTodo(data);\n    });\n    fetch(\"http://surpk-api-last.herokuapp.com/public/api/post\")\n      .then((response) => response.json())\n      .then((json) => {\n        setTimeout(() => {\n          this.todos = json;\n          console.log(json);\n          this.loading = true;\n        }, 1000);\n      });\n  },\n  data: function () {\n    return {\n      firstname: \"\",\n      lastname: \"\",\n      drawer: false,\n      dialog: false,\n      items: [\"СП-1\", \"СП-2\", \"СП-3\", \"СП-4\"],\n      todos: [],\n      token: null,\n    };\n  },\n\n  methods: {\n    delTodo(id) {\n      console.log(id);\n      fetch(`http://surpk-api-last.herokuapp.com/public/api/post/${id[0]}`, {\n        headers: {\n          Authorization: `Bearer ${this.getToken()}`,\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n        },\n        method: \"DELETE\",\n      }).then((response) => {\n        if (response.status == 202) {\n          this.alert(\"Удаление успешно\", \"info\");\n          this.todos.splice(id[1], 1);\n        } else {\n          if (response.status == 401) {\n            this.alert(\"Ошибка аутентификации\", \"error\");\n          } else {\n            this.alert(\"Ошибка\", \"error\");\n          }\n        }\n      });\n    },\n    startTodo(id) {\n      console.log(id);\n      fetch(`http://surpk-api-last.herokuapp.com/public/api/post/${id[0]}`, {\n        headers: {\n          Authorization: `Bearer ${this.getToken()}`,\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({ status: 2 }),\n        method: \"PATCH\",\n      }).then((response) => {\n        if (response.status == 202) {\n          this.alert(\"Заявка принята\", \"success\");\n          this.todos[id[1]].status = 2;\n        } else {\n          if (response.status == 401) {\n            this.alert(\"Ошибка аутентификации\", \"error\");\n          } else {\n            this.alert(\"Ошибка\", \"error\");\n          }\n        }\n      });\n    },\n    finishTodo(id) {\n      console.log(id);\n      fetch(`http://surpk-api-last.herokuapp.com/public/api/post/${id[0]}`, {\n        headers: {\n          Authorization: `Bearer ${this.getToken()}`,\n          Accept: \"application/json\",\n          \"Content-Type\": \"application/json\",\n        },\n        body: JSON.stringify({ status: 3 }),\n        method: \"PATCH\",\n      }).then((response) => {\n        if (response.status == 202) {\n          this.alert(\"Заявка завершена\", \"success\");\n          this.todos[id[1]].status = 3;\n        } else {\n          if (response.status == 401) {\n            this.alert(\"Ошибка аутентификации\", \"error\");\n          } else {\n            this.alert(\"Ошибка\", \"error\");\n          }\n        }\n      });\n    },\n\n    async createTodo(data) {\n      let result;\n      let s = await fetch(\n        `http://surpk-api-last.herokuapp.com/public/api/post`,\n        {\n          headers: {\n            Authorization: `Bearer ${this.getToken()}`,\n            Accept: \"application/json\",\n            \"Content-Type\": \"application/json\",\n          },\n          body: JSON.stringify(data),\n          method: \"POST\",\n        }\n      )\n        .then((response) => {\n          if (response.status == 201) {\n            this.alert(\"Создание успешно\", \"info\");\n            result = 1;\n          } else {\n            if (response.status == 401) {\n              this.alert(\"Ошибка аутентификации\", \"error\");\n            } else {\n              this.alert(\"Ошибка\", \"error\");\n            }\n          }\n          return response.json();\n        })\n        .then((data) => {\n          return data;\n        });\n      if (result == 1) {\n        s.user = this.getUsername();\n        s.status = 1;\n        console.log(s);\n\n        this.todos.push(s);\n      }\n    },\n    alert(text, type, duration) {\n      this.$emit(\"alert\", text, type, duration);\n    },\n    getToken() {\n      if (this.token == null) {\n        let user = JSON.parse(localStorage.getItem(\"user\"));\n        this.token = user.token;\n      }\n      return this.token;\n    },\n    getUsername() {\n      if (this.username == null) {\n        let user = JSON.parse(localStorage.getItem(\"user\"));\n        this.username = user.username;\n      }\n      return this.username;\n    },\n    // addTodo(todoNew) {\n    //   // console.log(this);\n    //   // console.log(todoNew);\n    // },\n  },\n};\n</script>\n<style>\n.fade-enter {\n  opacity: 0;\n}\n\n.fade-enter-active {\n  animation: fadein 1s;\n}\n\n.fade-leave {\n  opacity: 1;\n}\n\n.fade-leave-active {\n  animation: fadein 1s reverse;\n}\n\n@keyframes fadein {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n.w-100 {\n  width: 100%;\n}\n</style>\n"]}]}